--- libclamav/message.c.orig	2003-11-05 11:59:53.000000000 +0100
+++ libclamav/message.c	2004-02-09 18:36:43.215707744 +0100
@@ -878,13 +878,15 @@ decodeLine(const message *m, const char 
 			if(strcasecmp(line, "end") == 0)
 				break;
 
-			assert(strlen(line) <= 62);
+			if (strlen(line) > 62)
+			    break;
 			if((line[0] & 0x3F) == ' ')
 				break;
 
 			len = *line++ - ' ';
 
-			assert((len >= 0) && (len <= 63));
+			if ((len < 0) || (len > 63))
+			    break;
 
 			ptr = decode(line, ptr, uudecode, (len & 3) == 0);
 			break;
