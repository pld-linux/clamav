--- clamav-0.96.1/configure.ac~	2010-05-19 14:23:09.000000000 +0200
+++ clamav-0.96.1/configure.ac	2010-05-20 09:28:22.297294559 +0200
@@ -430,8 +430,12 @@
 AC_SUBST([BUILD_CONFIGURE_FLAGS], [$build_configure_args])
 
 AX_CHECK_UNAME_SYSCALL
+AC_CHECK_FUNC(socket,, [
 AC_CHECK_LIB([socket], [bind], [LIBS="$LIBS -lsocket"; CLAMAV_MILTER_LIBS="$CLAMAV_MILTER_LIBS -lsocket"; FRESHCLAM_LIBS="$FRESHCLAM_LIBS -lsocket"; CLAMD_LIBS="$CLAMD_LIBS -lsocket"])
+])
+AC_CHECK_FUNC(gethostent,, [
 AC_SEARCH_LIBS([gethostent],[nsl], [(LIBS="$LIBS -lnsl"; CLAMAV_MILTER_LIBS="$CLAMAV_MILTER_LIBS -lnsl"; FRESHCLAM_LIBS="$FRESHCLAM_LIBS -lnsl"; CLAMD_LIBS="$CLAMD_LIBS -lnsl")])
+])
 
 AC_CHECK_FUNCS([poll setsid memcpy snprintf vsnprintf strerror_r strlcpy strlcat strcasestr inet_ntop setgroups initgroups ctime_r mkstemp mallinfo madvise])
 AC_FUNC_FSEEKO
